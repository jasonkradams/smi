
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jasonkradams.github.io/smi/proposals/automate-member-license-sorting/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../google-workspace/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Automate Member License Sorting - Spokane Mountaineers Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#automating-member-license-sorting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Spokane Mountaineers Docs" class="md-header__button md-logo" aria-label="Spokane Mountaineers Docs" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Spokane Mountaineers Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Automate Member License Sorting
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jasonkradams/smi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../articles/" class="md-tabs__link">
          
  
  
    
  
  Articles

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../implementation/" class="md-tabs__link">
          
  
  
    
  
  Implementation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../how-to-guides/" class="md-tabs__link">
          
  
  
    
  
  How-To Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../automation/" class="md-tabs__link">
          
  
  
    
  
  Automation

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Proposals

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../google-workspace/" class="md-tabs__link">
          
  
  
    
  
  Google Workspace

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Spokane Mountaineers Docs" class="md-nav__button md-logo" aria-label="Spokane Mountaineers Docs" data-md-component="logo">
      
  <img src="../../assets/images/logo.png" alt="logo">

    </a>
    Spokane Mountaineers Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jasonkradams/smi" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../articles/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Articles
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Articles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/simplifying-custom-login-experience/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Migrating to Email-Based Login
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/activity-group-event-notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Activity Group Event Notifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/fixing-approval-email-notifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fixing Approval Email Notifications
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/experience-cloud-account-access-restriction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Restricting Account Access
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/enable-google-login/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enabling Google Login
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/event-participant-follow-handler-update/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Participant Follow Handler Update
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/event-participant-privacy-solution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Participant Privacy (Overview)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../articles/event-participant-redirect/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Participant Privacy (Technical)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../implementation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Implementation
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Implementation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/custom-login-page-implementation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Login Page
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../implementation/chatter-publisher-autosave/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chatter Publisher with Autosave
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../how-to-guides/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    How-To Guides
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/configure-custom-login-page/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configure Custom Login Page
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/setup-staging-sandbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup Staging Sandbox
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/update-experience-cloud-favicon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Customize Favicon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/keepalive-sessions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preventing Logout With KeepAlives
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/website-editing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Website Editing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/bulk-delete-events-in-salesforce/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bulk Delete Events in Salesforce
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-guides/salesforce-development-console-cheatsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Salesforce Development Console Cheatsheet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../automation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Automation
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Automation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/event-approval-email-alerts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Approval Email Alerts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/event-chatter-batch-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Chatter Batch Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/event-chatter-batch-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Chatter Batch Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/event-chatter-batch-production-deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event Chatter Batch Production Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/google-login-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Google Login Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/notify-leader-on-rsvp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notify Leader on RSVP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/notify-subscribers-new-event/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notify Subscribers of New Event
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../automation/scheduled-add-members-to-conservation-group/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scheduled Add Aembers to Conservation Group
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Proposals
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Proposals
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Automate Member License Sorting
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Automate Member License Sorting
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-statement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem Statement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem Statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Constraints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Indicators
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flow Diagram
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#license-shuffling-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        License Shuffling Algorithm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Profile Mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expected-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Expected Outcomes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expected Outcomes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benefits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Benefits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#risks-and-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Risks and Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Risks and Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#technical-risks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Technical Risks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#business-risks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Business Risks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mitigation-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mitigation Strategies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-foundation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: Foundation ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-core-logic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Core Logic ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Testing ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-deployment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Deployment &amp; Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 5: Documentation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Notes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Implementation Details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Classes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup Scripts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-setup-one-time" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initial Setup (One-Time)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ongoing-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ongoing Operations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Enhancements
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Status
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../google-workspace/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Google Workspace
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Google Workspace
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../google-workspace/querying-custom-user-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Querying Custom User Schema
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-statement" class="md-nav__link">
    <span class="md-ellipsis">
      
        Problem Statement
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problem Statement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-constraints" class="md-nav__link">
    <span class="md-ellipsis">
      
        System Constraints
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-indicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        Usage Indicators
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Solution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flow Diagram
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#license-shuffling-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        License Shuffling Algorithm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile-mapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Profile Mapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      
        Logging
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expected-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Expected Outcomes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Expected Outcomes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#benefits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Benefits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#risks-and-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Risks and Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Risks and Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#technical-risks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Technical Risks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#business-risks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Business Risks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mitigation-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mitigation Strategies
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-foundation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: Foundation ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-core-logic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Core Logic ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Testing ✅
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-deployment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Deployment &amp; Setup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 5: Documentation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Notes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#testing-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing Configuration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-implementation-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Implementation Details
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-classes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Test Classes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Setup Scripts
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Deployment Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initial-setup-one-time" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initial Setup (One-Time)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ongoing-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ongoing Operations
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Future Enhancements
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Status
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/jasonkradams/smi/edit/main/docs/proposals/automate-member-license-sorting.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/jasonkradams/smi/raw/main/docs/proposals/automate-member-license-sorting.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="automating-member-license-sorting">Automating Member License Sorting<a class="headerlink" href="#automating-member-license-sorting" title="Permanent link">&para;</a></h1>
<p><strong>Status</strong>: Ready for Deployment<br />
<strong>Created</strong>: 2025-12-08<br />
<strong>Author</strong>: Jason Adams<br />
<strong>Related Issue</strong>: <a href="https://github.com/jasonkradams/smi/issues/42">#42</a></p>
<h2 id="problem-statement">Problem Statement<a class="headerlink" href="#problem-statement" title="Permanent link">&para;</a></h2>
<p>The Spokane Mountaineers manage two types of Salesforce Community licenses:</p>
<ul>
<li><strong>Customer Community Plus (Premium)</strong>: ~$9–$10 per member per year, unlimited logins</li>
<li><strong>Customer Community Plus Login (Login-Based)</strong>: ~$1.50 per member per year, pooled 5,000 total logins per year</li>
</ul>
<p>The system automatically optimizes license assignments to address:</p>
<ul>
<li>Inefficient license usage (Premium licenses assigned to low-usage members)</li>
<li>Cost optimization opportunities</li>
<li>Manual administrative overhead</li>
<li>Risk of exceeding license limits</li>
</ul>
<h3 id="system-constraints">System Constraints<a class="headerlink" href="#system-constraints" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>505 Premium licenses available</strong> (maximum: 475 assigned)</li>
<li><strong>Chairs must remain Premium</strong> (Profile: <code>SM Community Plus Chair</code>)</li>
<li><strong>New users (&lt;90 days old) must remain Premium</strong> (to allow for initial usage patterns)</li>
<li><strong>200 Plus Login licenses</strong> included in contract</li>
</ul>
<h3 id="usage-indicators">Usage Indicators<a class="headerlink" href="#usage-indicators" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Plus Login → Plus</strong>: More than <strong>5</strong> logins per year</li>
<li><strong>Plus → Plus Login</strong>: <strong>5 or fewer</strong> logins per year</li>
<li><strong>Maximum Premium licenses</strong>: 475 (if more than 475 users qualify, top 475 by login count get Premium)</li>
</ul>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">&para;</a></h2>
<p>Automate license optimization through a scheduled batch process that:</p>
<ol>
<li><strong>Runs daily</strong> to optimize license assignments</li>
<li><strong>Assigns Premium licenses</strong> to users with &gt;5 logins, up to a maximum of 475 Premium licenses</li>
<li><strong>Protects critical users</strong> (Chairs and new users &lt;90 days) - they always get Premium</li>
<li><strong>Prioritizes by login count</strong> - if more than 475 users qualify, top 475 by login count get Premium</li>
<li><strong>Tracks full fiscal year</strong> login history via custom object (LoginHistory API only provides 6 months)</li>
<li><strong>Logs all changes</strong> for auditing and compliance</li>
</ol>
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permanent link">&para;</a></h2>
<h3 id="components">Components<a class="headerlink" href="#components" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Fiscal_Year_Login_History__c</strong> (Custom Object)</p>
<ul>
<li>Mirrors LoginHistory records to track full fiscal year (Feb 1 - Jan 31) login activity</li>
<li>Required because LoginHistory API only provides 6 months of data</li>
<li>Fields mirror LoginHistory structure with external ID on <code>Login_History_Id__c</code> to prevent duplicates</li>
<li>Located in: <code>force-app/main/default/objects/Fiscal_Year_Login_History__c/</code></li>
</ul>
</li>
<li>
<p><strong>LoginHistorySyncBatch</strong> (<code>Database.Batchable</code>, <code>Database.Stateful</code>)</p>
<ul>
<li>Runs daily to sync LoginHistory records to Fiscal_Year_Login_History__c</li>
<li>Queries LoginHistory from last 2 days and upserts to custom object</li>
<li>Triggers LicenseShuffleBatch in finish() method to ensure sync completes before shuffling</li>
<li>Located in: <code>force-app/main/default/classes/LoginHistorySyncBatch.cls</code></li>
</ul>
</li>
<li>
<p><strong>LoginHistorySyncScheduler</strong> (<code>Schedulable</code>)</p>
<ul>
<li>Schedules LoginHistorySyncBatch to run daily (e.g., 2:00 AM)</li>
<li>Located in: <code>force-app/main/default/classes/LoginHistorySyncScheduler.cls</code></li>
</ul>
</li>
<li>
<p><strong>LoginHistoryCleanupBatch</strong> (<code>Database.Batchable</code>)</p>
<ul>
<li>Runs annually on May 1st to delete records before February 1st of previous fiscal year</li>
<li>Keeps exactly one full fiscal year of data (Feb 1 - Jan 31)</li>
<li>Located in: <code>force-app/main/default/classes/LoginHistoryCleanupBatch.cls</code></li>
</ul>
</li>
<li>
<p><strong>LoginHistoryCleanupScheduler</strong> (<code>Schedulable</code>)</p>
<ul>
<li>Schedules LoginHistoryCleanupBatch to run annually on May 1st</li>
<li>Located in: <code>force-app/main/default/classes/LoginHistoryCleanupScheduler.cls</code></li>
</ul>
</li>
<li>
<p><strong>LicenseShuffleBatch</strong> (<code>Database.Batchable</code>, <code>Database.Stateful</code>)</p>
<ul>
<li>Queries all active Community users</li>
<li>Counts logins from <code>Fiscal_Year_Login_History__c</code> (fiscal year: Feb 1 - Jan 31)</li>
<li>Assigns Premium licenses to users with &gt;5 logins, up to maximum of 475</li>
<li>Updates licenses and profiles</li>
<li>Accumulates audit logs for later insertion</li>
<li>Located in: <code>force-app/main/default/classes/LicenseShuffleBatch.cls</code></li>
</ul>
</li>
<li>
<p><strong>LicenseChangeLogQueueable</strong> (<code>Queueable</code>)</p>
<ul>
<li>Handles insertion of <code>License_Change_Log__c</code> records in a separate transaction</li>
<li>Resolves <code>MIXED_DML_OPERATION</code> error (cannot mix User updates with custom object inserts)</li>
<li>Enqueued from <code>LicenseShuffleBatch.finish()</code> method</li>
<li>Located in: <code>force-app/main/default/classes/LicenseChangeLogQueueable.cls</code></li>
</ul>
</li>
<li>
<p><strong>License_Change_Log__c</strong> (Custom Object)</p>
<ul>
<li>Tracks all license changes</li>
<li>Stores: User, old/new license, old/new profile, login count, reason, timestamp, batch job ID</li>
<li>Located in: <code>force-app/main/default/objects/License_Change_Log__c/</code></li>
</ul>
</li>
<li>
<p><strong>LoginHistoryMigrationBatch</strong> (<code>Database.Batchable</code>, <code>Database.Stateful</code>)</p>
<ul>
<li>One-time batch class for initial data migration</li>
<li>Backfills <code>Fiscal_Year_Login_History__c</code> with existing LoginHistory records (last 6 months)</li>
<li>Used for initial setup before daily sync process begins</li>
<li>Located in: <code>force-app/main/default/classes/LoginHistoryMigrationBatch.cls</code></li>
</ul>
</li>
<li>
<p><strong>Field-Level Security Script</strong> (<code>grant_fls_fiscal_year_login_history.apex</code>)</p>
<ul>
<li>Anonymous Apex script to grant FLS access to System Administrator profile</li>
<li>Programmatically sets read/edit permissions for all Fiscal_Year_Login_History__c fields</li>
<li>Must be run after deploying the custom object (foundation step)</li>
<li>Located in: <code>scripts/apex/license-sorting/grant_fls_fiscal_year_login_history.apex</code></li>
</ul>
</li>
</ol>
<h3 id="flow-diagram">Flow Diagram<a class="headerlink" href="#flow-diagram" title="Permanent link">&para;</a></h3>
<p><img alt="License Sorting Flow Diagram" src="../automate-member-license-sorting-flow.svg" /></p>
<h2 id="implementation-details">Implementation Details<a class="headerlink" href="#implementation-details" title="Permanent link">&para;</a></h2>
<h3 id="license-shuffling-algorithm">License Shuffling Algorithm<a class="headerlink" href="#license-shuffling-algorithm" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>Identify Protected Users</strong>:</p>
<ul>
<li>Profile = <code>SM Community Plus Chair</code></li>
<li>CreatedDate &gt;= LAST_N_DAYS:90</li>
</ul>
</li>
<li>
<p><strong>Calculate Login Counts</strong>:</p>
<ul>
<li>Query <code>Fiscal_Year_Login_History__c</code> for each user (not LoginHistory - API only provides 6 months)</li>
<li><strong>Fiscal Year Logic</strong> (Fiscal Year: Feb 1 - Jan 31):<ul>
<li>If current month in {2,3,4} (Feb-Apr): Use <code>LAST_N_DAYS:365</code> (last 365 days - first 3 months of FY)</li>
<li>If current month &gt;= 5 (May-Dec): Use current fiscal year (Feb 1 of current year to now)</li>
<li>If current month == 1 (Jan): Use fiscal year (Feb 1 of previous year to now)</li>
</ul>
</li>
<li>Count total logins per user in the relevant period</li>
</ul>
</li>
<li>
<p><strong>Identify Qualifying Users</strong>:</p>
<ul>
<li><strong>Protected users</strong>: Always get Premium (Chairs and new users &lt;90 days)</li>
<li><strong>Qualifying users</strong>: Users with &gt;5 logins qualify for Premium</li>
</ul>
</li>
<li>
<p><strong>Calculate Premium License Assignments</strong>:</p>
<ul>
<li>Always include all protected users (they must be Premium)</li>
<li>Include all users with &gt;5 logins</li>
<li>If total exceeds 475, sort all qualifying users by login count (descending) and take top 475</li>
<li>Maximum: 475 Premium licenses total</li>
</ul>
</li>
<li>
<p><strong>Execute Changes</strong>:</p>
<ul>
<li>Assign Premium to users in the keep list (protected + top qualifying users up to 475)</li>
<li>Assign Login to users not in the keep list (users with ≤5 logins, or qualifying users beyond the 475 limit)</li>
</ul>
</li>
</ol>
<h3 id="profile-mapping">Profile Mapping<a class="headerlink" href="#profile-mapping" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Customer Community Plus</strong> → Profile: <code>SM Community Plus Member</code></li>
<li><strong>Customer Community Plus Login</strong> → Profile: <code>SM Community Plus Login</code></li>
<li><strong>Chairs</strong> → Profile: <code>SM Community Plus Chair</code> (always Premium, never changed)</li>
</ul>
<h3 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h3>
<p>All license changes are logged to <code>License_Change_Log__c</code> with:</p>
<ul>
<li>User reference</li>
<li>Old and new license types</li>
<li>Old and new profile names</li>
<li>Login count at time of change</li>
<li>Reason for change ("Low usage" or "High usage")</li>
<li>Timestamp (<code>Changed_At__c</code>)</li>
<li>Batch job ID</li>
</ul>
<p><strong>Important</strong>: Due to Salesforce's <code>MIXED_DML_OPERATION</code> restriction, log records are inserted via a <code>Queueable</code> job that runs after the batch completes. This means:</p>
<ul>
<li>User license changes happen immediately</li>
<li>Log records are created shortly after (typically within seconds)</li>
<li>If the Queueable job fails, check debug logs for error details</li>
</ul>
<h2 id="expected-outcomes">Expected Outcomes<a class="headerlink" href="#expected-outcomes" title="Permanent link">&para;</a></h2>
<h3 id="benefits">Benefits<a class="headerlink" href="#benefits" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Automated Management</strong>: Eliminates manual license assignment overhead</li>
<li><strong>Proactive Optimization</strong>: Automatically rebalances when usage patterns change</li>
<li><strong>Audit Trail</strong>: Provides complete logging of all license changes for compliance</li>
<li><strong>Full Fiscal Year Tracking</strong>: Maintains complete fiscal year login history (not limited to 6 months like LoginHistory API)</li>
</ul>
<h3 id="metrics">Metrics<a class="headerlink" href="#metrics" title="Permanent link">&para;</a></h3>
<ul>
<li>Premium licenses assigned: Up to 475 (based on users with &gt;5 logins)</li>
<li>Manual license management time: Near zero (automated daily)</li>
<li>License changes logged: 100% of all changes</li>
<li>Login history tracking: Full fiscal year (Feb 1 - Jan 31)</li>
</ul>
<h2 id="risks-and-considerations">Risks and Considerations<a class="headerlink" href="#risks-and-considerations" title="Permanent link">&para;</a></h2>
<h3 id="technical-risks">Technical Risks<a class="headerlink" href="#technical-risks" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Governor Limits</strong>: LoginHistory queries are expensive; batch size is set to 50 users per batch to stay within limits</li>
<li><strong>Query Performance</strong>: Large <code>Fiscal_Year_Login_History__c</code> tables may impact batch execution time</li>
<li><strong>LoginHistory API Limitation</strong>: LoginHistory API only provides 6 months of data<ul>
<li><strong>Mitigation</strong>: Custom object <code>Fiscal_Year_Login_History__c</code> tracks full fiscal year via daily sync</li>
</ul>
</li>
<li><strong>Error Handling</strong>: Users with validation rules or required fields may fail to update (errors are logged but don't stop the batch)</li>
<li><strong>MIXED_DML_OPERATION</strong>: Cannot update User (setup object) and insert <code>License_Change_Log__c</code> (non-setup object) in the same transaction<ul>
<li><strong>Mitigation</strong>: Log records are inserted via <code>LicenseChangeLogQueueable</code> in a separate transaction</li>
</ul>
</li>
<li><strong>Data Sync Timing</strong>: <code>LoginHistorySyncBatch</code> must complete before <code>LicenseShuffleBatch</code> runs<ul>
<li><strong>Mitigation</strong>: <code>LicenseShuffleBatch</code> is triggered from <code>LoginHistorySyncBatch.finish()</code> method</li>
</ul>
</li>
<li><strong>Field-Level Security</strong>: System Administrators require FLS permissions for <code>Fiscal_Year_Login_History__c</code> fields<ul>
<li><strong>Mitigation</strong>: FLS grant script (<code>scripts/apex/license-sorting/grant_fls_fiscal_year_login_history.apex</code>) programmatically sets permissions</li>
</ul>
</li>
</ul>
<h3 id="business-risks">Business Risks<a class="headerlink" href="#business-risks" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>User Experience</strong>: License changes may affect user access (mitigated by protecting Chairs and new users &lt;90 days)</li>
<li><strong>Timing</strong>: Batch runs daily; changes may lag behind actual usage patterns by up to 24 hours</li>
<li><strong>Edge Cases</strong>: Users with exactly 5 logins may oscillate between licenses depending on other qualifying users and the 475 Premium license limit</li>
</ul>
<h3 id="mitigation-strategies">Mitigation Strategies<a class="headerlink" href="#mitigation-strategies" title="Permanent link">&para;</a></h3>
<ul>
<li>Comprehensive test coverage (&gt;75% for all classes)</li>
<li>Idempotent batch design (safe to run multiple times)</li>
<li>Detailed error logging to <code>License_Change_Log__c</code> and debug logs</li>
<li>Protected users (Chairs and new members) always retain Premium licenses</li>
<li>Manual batch execution available for immediate optimization when needed</li>
</ul>
<h2 id="implementation-plan">Implementation Plan<a class="headerlink" href="#implementation-plan" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-foundation">Phase 1: Foundation ✅<a class="headerlink" href="#phase-1-foundation" title="Permanent link">&para;</a></h3>
<ul>
<li>Create <code>License_Change_Log__c</code> custom object and fields</li>
<li>Create <code>Fiscal_Year_Login_History__c</code> custom object and fields</li>
<li>Create <code>LicenseShuffleBatch</code> class skeleton</li>
<li>Create FLS grant script for field-level security setup</li>
</ul>
<h3 id="phase-2-core-logic">Phase 2: Core Logic ✅<a class="headerlink" href="#phase-2-core-logic" title="Permanent link">&para;</a></h3>
<ul>
<li>Implement fiscal year login counting logic using <code>Fiscal_Year_Login_History__c</code></li>
<li>Implement license shuffling algorithm (&gt;5 logins, max 475 Premium)</li>
<li>Implement logging functionality via Queueable class</li>
<li>Create <code>LoginHistorySyncBatch</code> for daily data sync</li>
<li>Create <code>LoginHistoryCleanupBatch</code> for annual data cleanup</li>
</ul>
<h3 id="phase-3-testing">Phase 3: Testing ✅<a class="headerlink" href="#phase-3-testing" title="Permanent link">&para;</a></h3>
<ul>
<li>Create comprehensive test classes for all components</li>
<li>Test all scenarios (upgrade, downgrade, protected users, edge cases)</li>
<li>Verify governor limit handling and batch processing</li>
<li>Test job chaining (sync batch triggers shuffle batch)</li>
</ul>
<h3 id="phase-4-deployment-setup">Phase 4: Deployment &amp; Setup<a class="headerlink" href="#phase-4-deployment-setup" title="Permanent link">&para;</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Deploy all components to staging environment</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Create Fiscal_Year_Login_History__c custom object and fields</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Create LoginHistorySyncBatch and scheduler</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Create LoginHistoryCleanupBatch and scheduler</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Update LicenseShuffleBatch to use custom object and new logic</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Create LoginHistoryMigrationBatch for initial data backfill</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Create FLS grant script for field-level security setup</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Run FLS grant script to set permissions</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Run initial data migration (LoginHistoryMigrationBatch) to backfill last 6 months</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Schedule <code>LoginHistorySyncScheduler</code> to run daily</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Schedule <code>LoginHistoryCleanupScheduler</code> to run annually on May 1st</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Monitor initial runs and verify functionality</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Deploy to production after testing complete</li>
</ul>
<h3 id="phase-5-documentation">Phase 5: Documentation<a class="headerlink" href="#phase-5-documentation" title="Permanent link">&para;</a></h3>
<ul class="task-list">
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Document system architecture and components</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Document Queueable class and MIXED_DML workaround</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled checked/><span class="task-list-indicator"></span></label> Document setup scripts and deployment steps</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Create admin guide for monitoring</li>
<li class="task-list-item"><label class="task-list-control"><input type="checkbox" disabled/><span class="task-list-indicator"></span></label> Document troubleshooting procedures</li>
</ul>
<h2 id="implementation-notes">Implementation Notes<a class="headerlink" href="#implementation-notes" title="Permanent link">&para;</a></h2>
<h3 id="testing-configuration">Testing Configuration<a class="headerlink" href="#testing-configuration" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Max Premium Licenses</strong>: 475</li>
<li><strong>Login Threshold</strong>: &gt;5 logins qualify for Premium</li>
<li><strong>Fiscal Year</strong>: Feb 1 - Jan 31</li>
<li><strong>Manual Execution</strong>: Can trigger LoginHistorySyncBatch or LicenseShuffleBatch directly</li>
</ul>
<h3 id="key-implementation-details">Key Implementation Details<a class="headerlink" href="#key-implementation-details" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Batch Size</strong>: 50 users per chunk for LicenseShuffleBatch, 200 for LoginHistorySyncBatch and LoginHistoryMigrationBatch</li>
<li><strong>Stateful Processing</strong>: Uses <code>Database.Stateful</code> to track Premium users across chunks</li>
<li><strong>Log Insertion</strong>: Logs are accumulated during batch execution and inserted via Queueable after completion</li>
<li><strong>Protected Users</strong>: Chairs and users &lt;90 days old always get Premium licenses</li>
<li><strong>Daily Sync</strong>: LoginHistorySyncBatch runs daily to sync LoginHistory to custom object</li>
<li><strong>Annual Cleanup</strong>: LoginHistoryCleanupBatch runs May 1st to delete records before previous fiscal year</li>
<li><strong>Job Chaining</strong>: LoginHistorySyncBatch triggers LicenseShuffleBatch in finish() method</li>
<li><strong>Field-Level Security</strong>: System Administrator profile requires FLS permissions for Fiscal_Year_Login_History__c fields (granted via script)</li>
<li><strong>Initial Migration</strong>: LoginHistoryMigrationBatch provides one-time backfill of last 6 months of LoginHistory data</li>
</ul>
<h3 id="test-classes">Test Classes<a class="headerlink" href="#test-classes" title="Permanent link">&para;</a></h3>
<ul>
<li><code>LicenseShuffleBatchTest.cls</code>: Comprehensive test coverage for batch logic</li>
<li><code>LicenseChangeLogQueueableTest.cls</code>: Tests Queueable log insertion</li>
<li><code>LoginHistorySyncBatchTest.cls</code>: Tests sync batch logic</li>
<li><code>LoginHistorySyncSchedulerTest.cls</code>: Tests sync scheduler</li>
<li><code>LoginHistoryCleanupBatchTest.cls</code>: Tests cleanup batch logic</li>
<li><code>LoginHistoryCleanupSchedulerTest.cls</code>: Tests cleanup scheduler</li>
<li><code>LoginHistoryMigrationBatch</code>: Includes test methods for initial migration logic</li>
</ul>
<h3 id="setup-scripts">Setup Scripts<a class="headerlink" href="#setup-scripts" title="Permanent link">&para;</a></h3>
<ul>
<li><code>scripts/apex/license-sorting/grant_fls_fiscal_year_login_history.apex</code>: Grants FLS permissions to System Administrator profile</li>
<li><code>scripts/apex/license-sorting/migrate_login_history_initial.apex</code>: Executes LoginHistoryMigrationBatch for initial data backfill</li>
<li><code>scripts/apex/license-sorting/README.md</code>: Documentation for all license sorting scripts</li>
</ul>
<h2 id="deployment-steps">Deployment Steps<a class="headerlink" href="#deployment-steps" title="Permanent link">&para;</a></h2>
<h3 id="initial-setup-one-time">Initial Setup (One-Time)<a class="headerlink" href="#initial-setup-one-time" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Deploy Components</strong>: Deploy all Apex classes, custom objects, and fields to target org</li>
<li><strong>Grant Field-Level Security</strong>: Run <code>scripts/apex/license-sorting/grant_fls_fiscal_year_login_history.apex</code> in Anonymous Apex to grant FLS permissions</li>
<li><strong>Initial Data Migration</strong>: Run <code>scripts/apex/license-sorting/migrate_login_history_initial.apex</code> to backfill last 6 months of LoginHistory data</li>
<li><strong>Schedule Daily Sync</strong>: Schedule <code>LoginHistorySyncScheduler</code> to run daily (recommended: 2:00 AM)</li>
<li><strong>Schedule Annual Cleanup</strong>: Schedule <code>LoginHistoryCleanupScheduler</code> to run annually on May 1st</li>
</ol>
<h3 id="ongoing-operations">Ongoing Operations<a class="headerlink" href="#ongoing-operations" title="Permanent link">&para;</a></h3>
<ul>
<li>Daily sync automatically maintains <code>Fiscal_Year_Login_History__c</code> records</li>
<li>License shuffling runs automatically after each daily sync completes</li>
<li>Annual cleanup removes records older than one full fiscal year</li>
</ul>
<h2 id="future-enhancements">Future Enhancements<a class="headerlink" href="#future-enhancements" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Custom Metadata</strong>: Configurable thresholds (475 max Premium, 5 login threshold)</li>
<li><strong>Dashboard/Reports</strong>: Visualize license usage trends and fiscal year login activity</li>
<li><strong>Manual Trigger</strong>: Option to run optimization immediately (available via direct batch execution)</li>
<li><strong>Predictive Analytics</strong>: Forecast license needs based on usage trends</li>
<li><strong>Data Retention Policy</strong>: Configurable retention period for Fiscal_Year_Login_History__c records</li>
</ul>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://developer.salesforce.com/docs/atlas.en-us.object_reference.meta/object_reference/sforce_api_objects_loginhistory.htm">Salesforce LoginHistory Object Documentation</a></li>
<li><a href="https://help.salesforce.com/s/articleView?id=xcloud.users_login_history.htm&amp;type=5">Salesforce LoginHistory API Limitations</a> - Only 6 months of data available via API</li>
<li><a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_batch_interface.htm">Salesforce Batch Apex Best Practices</a></li>
<li>Internal notes from conversation with Matt Jeffries</li>
</ul>
<h2 id="status">Status<a class="headerlink" href="#status" title="Permanent link">&para;</a></h2>
<p>System is implemented and ready for production deployment. All components have been deployed to staging and tested. Initial data migration has been completed. System awaits scheduling of daily sync and annual cleanup jobs, followed by production deployment after final testing verification.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Proposals">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Proposals
              </div>
            </div>
          </a>
        
        
          
          <a href="../../google-workspace/" class="md-footer__link md-footer__link--next" aria-label="Next: Google Workspace Documentation">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Google Workspace Documentation
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/jasonkradams/smi" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>